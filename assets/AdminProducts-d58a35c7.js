import{P as U,D as M,M as v}from"./DeleteModal-d6c32b83.js";import{_ as y,o as d,c as i,a as t,h as c,j as u,F as b,f as k,g as V,k as C,l as N,r as P,b as f,t as p}from"./index-583170de.js";const D={props:["tempProduct","updateProduct","isNew"],data(){return{product:{}}}},A={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},B={class:"modal-dialog modal-xl"},L={class:"modal-content border-0"},F={class:"modal-header bg-dark text-white"},I={id:"productModalLabel",class:"modal-title"},S={key:0},T={key:1},$=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),j={class:"modal-body"},z={class:"row"},E={class:"col-sm-4"},q={class:"mb-2"},G={class:"mb-3"},H=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),J=["src"],K=t("h5",null,"多圖設置",-1),O={key:0},Q=["onUpdate:modelValue"],R=["src"],W={class:"col-sm-8"},X={class:"mb-3"},Y=t("label",{for:"title",class:"form-label"},"標題",-1),Z={class:"row"},tt={class:"mb-3 col-md-6"},et=t("label",{for:"category",class:"form-label"},"分類",-1),ot={class:"mb-3 col-md-6"},lt=t("label",{for:"price",class:"form-label"},"單位",-1),st={class:"row"},dt={class:"mb-3 col-md-6"},it=t("label",{for:"origin_price",class:"form-label"},"原價",-1),at={class:"mb-3 col-md-6"},nt=t("label",{for:"price",class:"form-label"},"售價",-1),ct=N(`<hr><div class="mb-3"><label for="description" class="form-label">產品描述</label><textarea id="description" type="text" class="form-control" placeholder="請輸入產品描述">
                </textarea></div><div class="mb-3"><label for="content" class="form-label">說明內容</label><textarea id="description" type="text" class="form-control" placeholder="請輸入說明內容">
                </textarea></div>`,3),rt={class:"mb-3"},ut={class:"form-check"},mt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),pt={class:"modal-footer"},ht=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function _t(s,o,e,w,n,r){return d(),i("div",A,[t("div",B,[t("div",L,[t("div",F,[t("h5",I,[e.isNew?(d(),i("span",S,"新增產品")):(d(),i("span",T,"編輯產品"))]),$]),t("div",j,[t("div",z,[t("div",E,[t("div",q,[t("div",G,[H,c(t("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>e.tempProduct.imageUrl=l),type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,512),[[u,e.tempProduct.imageUrl]])]),t("img",{class:"img-fluid",src:e.tempProduct.imageUrl,alt:""},null,8,J)]),t("div",null,[K,Array.isArray(e.tempProduct.imagesUrl)?(d(),i("div",O,[(d(!0),i(b,null,k(e.tempProduct.imagesUrl,(l,m)=>(d(),i(b,{key:m+777},[c(t("input",{type:"text",class:"form-control","onUpdate:modelValue":g=>e.tempProduct.imagesUrl[m]=g},null,8,Q),[[u,e.tempProduct.imagesUrl[m]]]),t("img",{src:e.tempProduct.imagesUrl[m],alt:"",class:"img-fluid mb-3"},null,8,R)],64))),128)),!e.tempProduct.imagesUrl.length||e.tempProduct.imagesUrl[e.tempProduct.imagesUrl.length-1]?(d(),i("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100",onClick:o[1]||(o[1]=l=>e.tempProduct.imagesUrl.push(""))}," 新增圖片 ")):(d(),i("button",{key:1,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:o[2]||(o[2]=l=>e.tempProduct.imagesUrl.pop())}," 刪除圖片 "))])):V("",!0)])]),t("div",W,[t("div",X,[Y,c(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":o[3]||(o[3]=l=>e.tempProduct.title=l)},null,512),[[u,e.tempProduct.title]])]),t("div",Z,[t("div",tt,[et,c(t("input",{id:"category",type:"text",class:"form-control","onUpdate:modelValue":o[4]||(o[4]=l=>e.tempProduct.category=l),placeholder:"請輸入分類"},null,512),[[u,e.tempProduct.category]])]),t("div",ot,[lt,c(t("input",{id:"unit",type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=l=>e.tempProduct.unit=l),placeholder:"請輸入單位"},null,512),[[u,e.tempProduct.unit]])])]),t("div",st,[t("div",dt,[it,c(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control","onUpdate:modelValue":o[6]||(o[6]=l=>e.tempProduct.origin_price=l),placeholder:"請輸入原價"},null,512),[[u,e.tempProduct.origin_price,void 0,{number:!0}]])]),t("div",at,[nt,c(t("input",{id:"price",type:"number",min:"0",class:"form-control","onUpdate:modelValue":o[7]||(o[7]=l=>e.tempProduct.price=l),placeholder:"請輸入售價"},null,512),[[u,e.tempProduct.price,void 0,{number:!0}]])])]),ct,t("div",rt,[t("div",ut,[c(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=l=>n.product.is_enabled=l),"true-value":1,"false-value":0},null,512),[[C,n.product.is_enabled,void 0,{number:!0}]]),mt])])])])]),t("div",pt,[ht,t("button",{type:"button",class:"btn btn-primary",onClick:o[9]||(o[9]=(...l)=>e.updateProduct&&e.updateProduct(...l))}," 確認 ")])])])],512)}const bt=y(D,[["render",_t]]),h="https://vue3-course-api.hexschool.io",_="asher_api",gt={data(){return{products:[],tempProduct:{imagesUrl:[]},isNew:!1,page:{}}},methods:{getProducts(s=1){const o=`${h}/v2/api/${_}/admin/products/?page=${s}`;this.$http.get(o).then(e=>{this.products=e.data.products,this.page=e.data.pagination}).catch(e=>{console.log(e)})},openModal(s,o){s==="create"?(this.productModal.show(),this.isNew=!0,this.tempProduct={imagesUrl:[]}):s==="edit"?(this.productModal.show(),this.isNew=!1,this.tempProduct={...o}):s==="delete"&&(this.delProductModal.show(),this.tempProduct={...o})},updateProduct(){let s=`${h}/v2/api/${_}/admin/product`,o="post";this.isNew||(s=`${h}/v2/api/${_}/admin/product/${this.tempProduct.id}`,o="put"),this.axios[o](s,{data:this.tempProduct}).then(e=>{alert(e.data.message),this.getProducts(),this.productModal.hide()}).catch(e=>{console.log(e)})},deleteProduct(){const s=`${h}/v2/api/${_}/admin/product/${this.tempProduct.id}`;this.$http.delete(s).then(o=>{alert(o.data.message),this.getProducts(),this.delProductModal.hide()}).catch(o=>{console.log(o)})}},components:{ProductModal:bt,Pagination:U,DeleteModal:M},mounted(){const s=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=s,this.getProducts(),this.productModal=new v("#productModal"),this.delProductModal=new v("#delProductModal")}},Pt={class:"container"},ft={class:"text-end mt-4"},vt={class:"table mt-4"},yt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),kt={key:0,class:"text-success"},wt={key:1},xt={class:"btn-group"},Ut=["onClick"],Mt=["onClick"];function Vt(s,o,e,w,n,r){const l=P("product-modal"),m=P("pagination"),g=P("delete-modal");return d(),i(b,null,[t("div",Pt,[t("div",ft,[t("button",{class:"btn btn-danger",onClick:o[0]||(o[0]=a=>r.openModal("create"))},"建立新的產品")]),t("table",vt,[yt,t("tbody",null,[(d(!0),i(b,null,k(n.products,a=>(d(),i("tr",{key:a.id},[t("td",null,p(a.category),1),t("td",null,p(a.title),1),t("td",null,p(a.origin_price),1),t("td",null,p(a.price),1),t("td",null,[a.is_enabled?(d(),i("span",kt,"啟用")):(d(),i("span",wt,"未啟用"))]),t("td",null,[t("div",xt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:x=>r.openModal("edit",a)}," 編輯 ",8,Ut),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:x=>r.openModal("delete",a)}," 刪除 ",8,Mt)])])]))),128))])])]),f(l,{"is-new":n.isNew,"temp-product":n.tempProduct,"update-product":r.updateProduct},null,8,["is-new","temp-product","update-product"]),f(m,{pages:n.page,"get-products":r.getProducts},null,8,["pages","get-products"]),f(g,{item:n.tempProduct,onDelItem:r.deleteProduct},null,8,["item","onDelItem"])],64)}const Dt=y(gt,[["render",Vt]]);export{Dt as default};
